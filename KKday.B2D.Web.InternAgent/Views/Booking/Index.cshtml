@using System.Globalization
@using Microsoft.AspNetCore.Mvc.Localization
@*@page*@
@inject IViewLocalizer Localizer
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    var prodOid = ViewData["prodOid"];
    var locale = CultureInfo.CurrentCulture;
}
@section Styles {
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/css/kkday_booking.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/kkday_32.css" asp-append-version="true" />
    @*<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">*@
    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
    <style type="text/css">
        .list-item-content-line {
            position: relative;
            height: 1px;
            margin: 5px 0;
            background-color: #3e3f40;
        }

        .list-item-content {
            background-color: #fbfbef;
        }

        .list-item-content-line:after {
            position: absolute;
            right: 0;
            content: '';
            top: -4px;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 4px 0 4.4px 8px;
            border-color: transparent transparent transparent #3e3f40;
        }

        .board-title[data-toggle=collapse] {
            padding-right: 30px;
        }

        .font-16 {
            font-size: 16px;
        }

        .train-class {
            background-color: #fbfbef;
        }

        .select2-container--default .select2-selection--single {
            border: 1px solid #e1e1e1;
        }

        .country-list .country:hover {
            background: #f2f2f2;
        }

        div:not(.datepicker) .dropdown-menu {
            max-height: 400px;
            overflow-y: auto;
        }

        .tel-country-item {
            display: block;
            width: 100%;
            color: #333;
            white-space: nowrap;
        }

        .w-40 {
            width: 40%;
        }

        .cus-route-item {
            border: 1px solid #d5d6db;
            border-radius: 8px;
            padding: 6px 12px;
            margin-right: 5px;
        }

        .tkt-qty {
            flex-basis: 90px;
            text-align: end;
        }
    </style>
}
@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
}

<h5>Booking Page</h5>
<div id="App" class="product-detail-wrap" data-pid="@prodOid">
    <div class="container">
        <div class="con">
            <div class="row">
                <div class="col-md-4 col-sm-6 col-xs-12">
                    <div class="form-group must">
                        <label><!--@*訂購人名*@-->@Localizer["booking_step1_buyer_first_name"]<span class="text-danger">*</span></label>
                        @* gc_b2d_chuiyi 不自動帶入訂購人名 => value="@contactInfo.NAME_FIRST"*@
                        <input type="text" class="form-control" id="txtLocalFname" name="txtLocalFname" placeholder="請輸入訂購人名" v-model="booking.buyer_first_name" />
                        @*<div class="tip text-danger">請輸入訂購人名</div>*@
                    </div>
                </div>
                <div class="col-md-4 col-sm-6 col-xs-12">
                    <div class="form-group must">
                        <label><!--@*訂購人姓*@-->@Localizer["booking_step1_buyer_last_name"]<span class="text-danger">*</span></label>
                        @* gc_b2d_chuiyi 不自動帶入訂購人姓 => value="@contactInfo.NAME_LAST"*@
                        <input type="text" class="form-control" id="txtLocalLname" name="txtLocalLname" placeholder="請輸入訂購人姓" v-model="booking.buyer_last_name" />
                        @*<div class="tip text-danger">請輸入訂購人姓</div>*@
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 col-sm-6 col-xs-12">
                    <div class="form-group must">
                        <label><!--@*國家/地區*@-->@Localizer["common_nationality"]<span class="text-danger">*</span></label>
                        @*<input type="text" class="form-control" id="txtNationality" name="txtNationality" placeholder="" value="@contactInfo.COUNTRY_CODE" />*@
                        <select class="form-control country" id="buyer-country" v-model="booking.buyer_country">
                            <option value="">--select--</option>
                            <template v-for="option in country_areas">
                                <option :value="option.country_code" v-html="`${option.country_name}`"></option>
                            </template>
                        </select>
                    </div>
                </div>
                <div class="col-md-4 col-sm-6 col-xs-12">
                    <div class="form-group must">
                        <label><!--@*電話*@-->@Localizer["member_basic_phoneNumber"]<span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="txtContactTel" name="txtContactTel" placeholder="" value="" v-model="booking.buyer_tel_number">
                        @*<div class="tip text-danger">no number</div>*@
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-8 col-xs-12">
                    <div class="form-group must">
                        <label>email<span class="text-danger">*</span></label>
                        <input type="email" class="form-control" id="txtEmail" name="txtEmail" placeholder="" value="" data-bv-callback="true" data-bv-callback-message="" data-bv-callback-callback="CheckContactEmail" v-model="booking.buyer_Email">
                        @*<label style="color:blue">email</label>*@
                    </div>
                </div>
            </div>
            <!-- Partner Order Number -->
            <div class="row">
                <div class="col-md-8 col-xs-12">
                    <div class="form-group must">
                        <label><!--@*分銷商訂編*@-->@Localizer["booking_step1_parner_order_no"]</label>
                        <input class="form-control" id="partnerOrderNo" name="partnerOrderNo" maxlength="30" placeholder="" value="" v-model="booking.partner_order_no">
                    </div>
                </div>
            </div>
        </div>

        <template v-if="bookingField?.custom?.cusType?.listOption?.indexOf('contact')>-1">
            contact

        </template>
        <template v-if="bookingField?.custom?.cusType?.listOption?.indexOf('cus_01')>-1">
            gggggggg_01

        </template>
        <template v-if="bookingField?.custom?.cusType?.listOption?.indexOf('cus_02')>-1">
            gggggggg_02

        </template>

        <div class="con">
            <!--@*旅客資料*@-->
            <template v-for="(pax, idx) in booking.custom">
                <div class="traveler-con">
                    <div class="d-flex">
                        <h3 class="flex-grow-1">
                            <!--@*旅客*@-->@Localizer["common_cus"] <span v-html="idx+1"></span>
                        </h3>
                        <span class="align-self-end" style="font-size: 2.6rem;" onclick="TogglePaxPanel(this)"><i class="fa fa-angle-up ml-auto" aria-hidden="true"></i></span>
                    </div>
                    <div class="board active pax-item">

                        <div class="d-flex">

                        </div>

                        <div class="clearfix"></div>
                        <div class="row">
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="checkBookingField('custom.nationality', 'cus_01,cus_02')">
                                <div class="form-group">
                                    <label><!--@*國家/地區*@-->@Localizer["common_nationality"]<span class="text-danger">*</span></label>
                                    <select class="form-control country" id="buyer-country" v-model="booking.custom[idx].nationality">
                                        <option value="">--select--</option>
                                        <template v-for="option in getBookingFieldReference('custom.nationality')">
                                            <option :value="option.code" v-html="`${option.name}`"></option>
                                        </template>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="checkBookingField('custom.nativeFirstName', 'cus_01,cus_02') && pax.nationality =='TW'">
                                <div class="form-group">
                                    <label><!--@*本國名*@--> <span v-html="`@Localizer["booking_step1_cust_data_local_firstname"]`"></span><span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["KHSR_Booking_FirstName_PlaceHolder"]" name="`localFirstName-${idx}`" type="text" maxlength="50" class="form-control"
                                           v-model="booking.custom[idx].native_first_name" data-bv-callback="true" data-bv-callback-message="@Localizer["KHSR_Booking_Alert_name_format"]" data-bv-callback-callback="BvCheckValidName" required>
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="checkBookingField('custom.nativeLastName', 'cus_01,cus_02') && pax.nationality =='TW'">
                                <div class="form-group">
                                    <label> <!--@*本國姓*@--> <span v-html="`@Localizer["booking_step1_cust_data_local_lastname"]`"></span><span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["KHSR_Booking_LastName_PlaceHolder"]" name="`localLastName-${idx}`" type="text" maxlength="50" class="form-control"
                                           v-model="booking.custom[idx].native_last_name" data-bv-callback="true" data-bv-callback-message="@Localizer["KHSR_Booking_Alert_name_format"]" data-bv-callback-callback="BvCheckValidName" required>
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="(checkBookingField('custom.englishFirstName', 'cus_01, cus_02') || checkBookingField('custom.nativeFirstName', 'cus_01,cus_02')) && pax.nationality !='TW'">
                                <div class="form-group">
                                    <label><!--@*旅客護照名(英文)*@-->@Localizer["booking_step1_cust_data_passport_english_firstname"]<span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["KHSR_Booking_FirstName_PlaceHolder"]" name="`enFirstName-${idx}`" type="text" maxlength="50" class="form-control" v-model="booking.custom[idx].english_first_name" required
                                           data-bv-callback="true" data-bv-callback-message="@Localizer["KHSR_Booking_Alert_name_format"]" data-bv-callback-callback="BvCheckValidName" />
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="(checkBookingField('custom.englishLastName', 'cus_01, cus_02') || checkBookingField('custom.nativeLastName', 'cus_01,cus_02')) && pax.nationality !='TW'">
                                <div class="form-group">
                                    <label><!--@*旅客護照姓(英文)*@-->@Localizer["booking_step1_cust_data_passport_english_lastname"]<span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["KHSR_Booking_LastName_PlaceHolder"]" name="`enlLastName-${idx}`" type="text" maxlength="50" class="form-control"
                                           v-model="booking.custom[idx].english_last_name" data-bv-callback="true" data-bv-callback-message="@Localizer["KHSR_Booking_Alert_name_format"]" data-bv-callback-callback="BvCheckValidName" required>
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="checkBookingField('custom.birth', 'cus_01,cus_02')">
                                <div class="form-group">
                                    <label><!--@*出生日期*@-->@Localizer["component_form_date_of_birth_title"]<span class="text-danger">*</span></label>
                                    <div class="input-group mb-3">
                                        <input type="text" name="`pax-birth-${idx}`" class="form-control"
                                               placeholder="@Localizer["component_form_title_placeholder"]" v-model="booking.custom[idx].birth" required
                                               data-bv-callback="true" data-bv-callback-message="@Localizer["KHSR_Booking_Alert_age_range"]" data-bv-callback-callback="BvCheckBirthWithTicketType" />
                                        <div class="input-group-append">
                                            <span class="input-group-text bg-white"><i class="icon-calendar icons"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="checkBookingField('custom.passportNo', 'cus_01,cus_02') && pax.nationality !='TW'">
                                <div class="form-group">
                                    <label><!--@*證件號碼 (護照/身分證)*@-->@Localizer["component_form_passport_number_title"]<span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["component_form_passport_number_placeholder"]" name="`passport-${idx}`" type="text" class="form-control"
                                           oninput="this.value=this.value.replace(/\s/g, '')" v-model="booking.custom[idx].passport_no" required />
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="checkBookingField('custom.passportExpdate', 'cus_01,cus_02') && pax.nationality !=`TW`">
                                <div class="form-group">
                                    <label><!--@*證件效期 (護照/身分證)*@-->@Localizer["component_form_passport_expire_date_title"]<span class="text-danger">*</span></label>
                                    <div class="input-group mb-3">
                                        <input type="text" name="`passport_expdate_${idx}`" placeholder=""
                                               readonly="readonly" class="form-control" v-model="booking.custom[idx].passport_expdate" required />
                                        <div class="input-group-append">
                                            <span class="input-group-text bg-white"><i class="icon-calendar icons"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="checkBookingField('custom.idNo', 'cus_01,cus_02') && pax.nationality ==`TW`">
                                <div class="form-group">
                                    <label><!--@*台灣身分證字號*@-->@Localizer["order_show_cust_data_tw_identity_number"]<span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["component_form_tw_identity_number_placeholder"]" name="`twIdentity-${idx}`" type="text" class="form-control"
                                           v-model="booking.custom[idx].id_no" oninput="this.value=this.value.replace(/\s/g, '')" required
                                           data-bv-callback="true" data-bv-callback-message="@Localizer["KHSR_Booking_Alert_TW_ID"]" data-bv-callback-callback="BvCheckTaiwanID" />
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="checkBookingField('custom.mtpNo', 'cus_01,cus_02') && pax.nationality ==`TW`">
                                <div class="form-group">
                                    <label><!--@*台胞證字號*@-->@Localizer["order_show_cust_data_mtp_number"]<span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["component_form_mtp_number_placeholder"]" name="`mtp_no-${idx}`" type="text" v-model="booking.custom[idx].mtp_no"
                                           oninput="this.value=this.value.replace(/\s/g, '')" class="form-control" required />
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="checkBookingField('custom.gender', 'cus_01,cus_02')">
                                <div class="form-group">
                                    <label><!--@*性別*@-->@Localizer["booking_step1_cus_cusGender"]<span class="text-danger">*</span></label>
                                    <select name="`pax-gender-${idx}`" class="form-control" v-model="booking.custom[idx].gender" required
                                            data-bv-callback="true" data-bv-callback-message="@Localizer["KHSR_Booking_Error_tw_gender_unmatch"]@*性別不符合台灣身分證號*@" data-bv-callback-callback="BvCheckGenderWithTWID">
                                        <option value="">@Localizer["component_form_gender_placeholder"]</option>
                                        <template v-for="gender in getBookingFieldReference('custom.gender')">
                                            <option :value="gender.id" v-html="gender.name"></option>
                                        </template>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12" v-show="checkBookingField('custom.telNumber', 'cus_01,cus_02')">
                                <div class="form-group">
                                    <label><!--@*聯絡電話*@-->@Localizer["component_form_contact_tel_title"]<span class="text-danger">*</span></label>
                                    <div class="input-group buyer-tel-country">

                                        <select name="`pax-gender-${idx}`" class="form-control" v-model="booking.custom[idx].tel_country_code" required
                                                data-bv-callback="true" data-bv-callback-message="@Localizer["KHSR_Booking_Error_tw_gender_unmatch"]@*性別不符合台灣身分證號*@" data-bv-callback-callback="BvCheckGenderWithTWID">
                                            <option value="">@Localizer["component_form_gender_placeholder"]</option>
                                            <template v-for="tel in getBookingFieldReference('custom.telCountryCode')">
                                                <option :value="tel.code" v-html="`${tel.info} ${tel.code}`"></option>
                                            </template>
                                        </select>
                                        <input placeholder="@Localizer["component_form_contact_tel_placeholder"]" type="tel" class="form-control form-phone" name="tel_number" v-model="booking.custom[idx].tel_number" autocomplete="off" required>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.height', 'cus_01,cus_02')">
                                <label><!--@*旅客身高*@-->@Localizer["booking_step1_cust_data_height"]<span class="text-danger">*</span></label>
                                <input placeholder="@Localizer["component_form_title_placeholder"]" autocomplete="on" type="number" name="height0-0" min="0" class="form-control" v-model="booking.custom[idx].height" required />
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.heightUnit', 'cus_01,cus_02')">
                                <label><!--@*身高單位*@-->@Localizer["booking_step1_cust_data_height"]<span class="text-danger">*</span></label>
                                <select name="heightUnit0-0" class="form-control" v-model="booking.custom[idx].height_unit" required>
                                    <option disabled="disabled" value=""><!--@*單位*@-->@Localizer["booking_step1_cust_data_unit"]</option>
                                    <template v-for="height in getBookingFieldReference('custom.heightUnit')">
                                        <option :value="height.id" v-html="`${height.name}`"></option>
                                    </template>
                                </select>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.weight', 'cus_01,cus_02')">
                                <label><!--@*旅客體重*@-->@Localizer["booking_step1_cust_data_weight"]<span class="text-danger">*</span></label>
                                <input placeholder="@Localizer["component_form_title_placeholder"]" autocomplete="on" type="number" name="weight0-0" min="0" class="form-control" v-model="booking.custom[idx].weight" required>
                            </div>
                            <div class="col-md-4 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.weightUnit', 'cus_01,cus_02')">
                                <label><!--@*體重單位*@-->@Localizer["booking_step1_cust_data_weight"]<span class="text-danger">*</span></label>
                                <select name="weightUnit0-0" class="form-control" v-model="booking.custom[idx].weight_unit" required>
                                    <option disabled="disabled" value=""><!--@*單位*@-->@Localizer["booking_step1_cust_data_unit"]</option>
                                    <template v-for="weight in getBookingFieldReference('custom.weightUnit')">
                                        <option :value="weight.id" v-html="`${weight.name}`"></option>
                                    </template>
                                </select>
                            </div>
                            <!--@*鞋碼*@-->
                            <div class="col-md-4 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.shoeType', 'cus_01,cus_02')">
                                <label><!--@*鞋碼種類*@-->@Localizer["booking_step1_cust_data_shoe_size"]<span class="text-danger">*</span></label>
                                <select :id="`shoeSizeType_${idx}`" class="form-control" name="shoeSizeType0-0" @@change="refreshShoeSize(idx)" v-model="booking.custom[idx].shoe_type" required>
                                    <option value=""><!--@*請選擇*@-->@Localizer["component_form_title_placeholder"]</option>
                                    <template v-for="temp in getBookingFieldReference('custom.shoeType')">
                                        <option :value="temp.id" v-html="`${temp.name}`"></option>
                                    </template>
                                </select>
                                <div class="tip kk-u-text-dark kk-u-text-body-sm">
                                    <!--@*如腳掌長低於19CM, 請選擇兒童鞋碼*@-->@Localizer["booking_step1_cust_data_shoe_size_tip"]
                                </div>
                            </div>
                            <div class="col-md-2 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.shoeUnit', 'cus_01,cus_02')">
                                <label><!--@*鞋碼單位*@-->@Localizer["booking_step1_cust_data_shoe_size"]<span class="text-danger">*</span></label>
                                <select :id="`shoeSizeUnit_${idx}`" class="form-control" name="shoeSizeUnit0-0" @@change="refreshShoeSize(idx)" v-model="booking.custom[idx].shoe_unit" required>
                                    <option value=""><!--@*請選擇*@-->@Localizer["booking_step1_cust_data_shoe_size_placeholder"]</option>
                                    <template v-for="temp in getBookingFieldReference('custom.shoeUnit')">
                                        <option :value="temp.id" v-html="`${temp.name}`"></option>
                                    </template>
                                </select>
                            </div>
                            <div class="col-md-2 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.shoe', 'cus_01,cus_02')">
                                <label><!--@*旅客鞋碼*@-->@Localizer["booking_step1_cust_data_shoe_size"]<span class="text-danger">*</span></label>
                                <select :id="`shoeSizeValue_${idx}`" class="form-control" name="shoeSizeValue0-0" v-model="booking.custom[idx].shoe" required>
                                    <option value=""><!--@*請選擇*@-->@Localizer["component_form_title_placeholder"]</option>
                                </select>
                            </div>
                            <!--@*眼鏡度數*@-->
                            <div class="col-md-4 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.glassDegree', 'cus_01,cus_02')">
                                <label><!--@*眼鏡度數*@-->@Localizer["booking_step1_cust_data_glass_diopter"] <span class="text-danger">*</span></label>
                                <select name="glassDiopter0-0" class="form-control" v-model="booking.custom[idx].glass_degree" required>
                                    <option disabled="disabled" value=""><!--@*請選擇眼鏡度數*@-->@Localizer["booking_step1_cust_data_glass_diopter_placeholder"]</option>
                                    <option value="0">@Localizer["booking_step1_cust_data_do_not_need"]</option>
                                    <template v-for="temp in getBookingFieldReference('custom.glassDegree')">
                                        <option :value="temp.code" v-html="`${temp.value}`"></option>
                                    </template>
                                </select>
                            </div>
                            <!--@*選擇餐食*@-->
                            <div class="col-md-4 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.meal', 'cus_01,cus_02')">
                                <label> <!--@*選擇餐食*@-->@Localizer["booking_step1_cust_data_meal"]<span class="text-danger">*</span></label>
                                <select class="form-control" name="meal0-0" v-model="booking.custom[idx].meal" required>
                                    <option disabled="disabled" value=""><!--@*請選擇餐食*@-->@Localizer["booking_step1_cust_data_meal_placeholder"]</option>
                                    <template v-for="temp in getBookingFieldReference('custom.meal')">
                                        <option :value="temp.mealType" v-html="temp.mealTypeName" v-if="temp.isProvided==true"></option>
                                    </template>
                                </select>
                            </div>
                        </div> <!-- row -->
                    </div>
                </div>
            </template>

            <!--@*導覽語言*@ -->
            <template v-show="bookingField?.guide_lang && bookingField?.guide_lang?.isRequire === true">
                <div class="traveler-con traveler-other">
                    <div class="sub-title">
                        <!--@*導覽語言標題*@-->@Localizer["common_guide_lang"]
                    </div> <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <div class="form-group">
                                <label><!--@*行程導覽語言*@-->@Localizer["booking_step1_product_guide_lang"]<span class="text-danger">*</span></label>
                                <select class="form-control" name="booking-guid-lang" v-model="booking.guide_lang" required>
                                    <option value="" disabled><!--@*請選擇*@-->@Localizer["component_form_title_placeholder"]</option>
                                    <template v-for="lang in bookingField.guide_lang?.listOption">
                                        <option :value="lang" v-html="lang"></option>
                                    </template>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- @*離開班機資訊*@ -->
            <template v-if="bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'flight')">
                <div class="traveler-con traveler-other">
                    <div class="sub-title">
                        <!--@*@離開%s班機資訊*@--> @Localizer["booking_step1_flight_info_departure_info"]?.Value.Replace("%s", string.Empty).Replace(" ", string.Empty)
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingFieldforFlight('departureFlightType')">
                            <div class="form-group">
                                <label><!--@*航班類型*@-->@Localizer["booking_step1_flight_info_flight_type"]<span class="text-danger">*</span></label>
                                <select id="booking-flight-departure-type" name="departureFlightType0" class="form-control"
                                        v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').departure_flightType" required>
                                    <option disabled="disabled" value=""><!--@*請選擇航班類型*@-->@Localizer["booking_step1_flight_info_flight_type_placeholder"]</option>
                                    <template v-for="temp in getBookingFieldReferenceforFlight('departureFlightType')">
                                        <option :value="temp.id" v-html="temp.name"></option>
                                    </template>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingFieldforFlight('departureAirport')">
                            <div class="form-group">
                                <label><!--@*出發機場*@-->@Localizer["booking_step1_flight_info_departure_airport"]<span class="text-danger">*</span></label>
                                <select id="booking-flight-departure-airport" class="form-control" name="departureAirport0"
                                        v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').departure_airport" required>
                                    <option disabled="disabled" value=""><!--@*請選擇出發機場*@-->@Localizer["booking_step1_flight_info_departure_airport_placeholder"]</option>
                                    <template v-for="temp in getBookingFieldReferenceforFlight('departureAirport')">
                                        <option :value="temp.code" v-html="temp.name"></option>
                                    </template>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingFieldforFlight('departureTerminalNo')">
                                <div class="form-group">
                                    <label><!--@*航廈*@-->@Localizer["order_show_flight_info_terminal_no"]<span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["booking_step1_flight_info_terminal_no_placeholder"]" autocomplete="on" type="text" id="booking-flight-departure-terminal" name="departureTerminal0" class="form-control"
                                           v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').departure_terminalNo" required />
                                </div>
                            </div>
                            <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingFieldforFlight('departureAirlineName')">
                                <div class="form-group">
                                    <label><!--@*航空公司*@-->@Localizer["booking_step1_flight_info_airline"]<span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["booking_step1_flight_info_airline_placeholder"]" autocomplete="on" type="text" id="booking-flight-departure-airline" name="departureAirline0" class="form-control"
                                           v-model="booking.traffic?.find(t=> t.traffic_type=='flight').departure_airlineName" required />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingFieldforFlight('departureFlightNo')">
                                <div class="form-group">
                                    <label><!--@*航班編號*@-->@Localizer["booking_step1_flight_info_flight_no"]<span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["booking_step1_flight_info_flight_no_placeholder"]" autocomplete="on" type="text" id="booking-flight-departure-flight-number" name="departureFlightNo0" class="form-control"
                                           v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').departure_flightNo" required />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforFlight('departureDate')">
                                <div class="form-group">
                                    <label><!--@*航班出發日期*@-->@Localizer["booking_step1_flight_info_departure_date"]<span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["booking_step1_flight_info_arrival_time_placeholder"]" autocomplete="on" type="text" id="booking-flight-departure-flight-number" name="departureFlightNo0" class="form-control"
                                           v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').departure_date" required />
                                </div>
                            </div>
                            <div class="col-sm-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforFlight('departureTime')">
                                <div class="form-group">
                                    <label><!--@*航班出發時間*@-->@Localizer["booking_step1_flight_info_departure_time"]<span class="text-danger">*</span></label>
                                    <input placeholder="@Localizer["booking_step1_flight_info_departure_time_placeholder"]" autocomplete="on" type="text" id="booking-flight-departure-flight-number" name="departureFlightNo0" class="form-control"
                                           v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').departure_time" required />
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </template>

            <!--@*抵達班機資訊*@-->
            <template v-if="bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'flight')">
                <div class="traveler-con traveler-other">
                    <div class="sub-title">
                        <!--@*抵達班機資訊*@-->@Localizer["booking_step1_flight_info_arrival_info"]?.Value.Replace("%s", string.Empty).Replace(" ", string.Empty)
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingFieldforFlight('arrivalFlightType')">
                            <div class="form-group">
                                <label><!--@*航班類型*@-->@Localizer["booking_step1_flight_info_flight_type"]<span class="text-danger">*</span></label>
                                <select id="booking-flight-arrival-type" name="arrivalFlightType0" class="form-control"
                                        v-model="booking.traffic.find(t=> t.traffic_type=='flight').arrival_flightType" required>
                                    <option disabled="disabled" value=""><!--@*請選擇航班類型*@-->@Localizer["booking_step1_flight_info_flight_type_placeholder"]</option>
                                    <template v-for="temp in getBookingFieldReferenceforFlight('arrivalFlightType')">
                                        <option :value="temp.id" v-html="temp.name"></option>
                                    </template>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingFieldforFlight('arrivalAirport')">
                            <div class="form-group">
                                <label><!--@*抵達機場*@-->@Localizer["booking_step1_flight_info_arrival_airport"]<span class="text-danger">*</span></label>
                                <select id="booking-flight-arrival-airport" class="form-control" name="arrivalAirport0"
                                        v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').arrival_airport" required>
                                    <option disabled="disabled" value=""><!--@*選擇抵達機場*@-->@Localizer["booking_step1_flight_info_arrival_airport_placeholder"]</option>
                                    <template v-for="temp in getBookingFieldReferenceforFlight('arrivalAirport')">
                                        <option :value="temp.code" v-html="temp.name"></option>
                                    </template>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforFlight('arrivalTerminalNo')">
                            <label><!--@*航廈*@-->@Localizer["booking_step1_flight_info_terminal_no"]<span class="text-danger">*</span></label>
                            <input placeholder="@Localizer["booking_step1_flight_info_terminal_no_placeholder"]" autocomplete="on" type="text" id="booking-flight-arrival-terminal" name="arrivalTerminal0" class="form-control"
                                   v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').arrival_terminalNo" required>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforFlight('arrivalAirlineName')">
                            <label><!--@*航空公司*@-->@Localizer["booking_step1_flight_info_airline"]<span class="text-danger">*</span></label>
                            <input placeholder="@Localizer["booking_step1_flight_info_airline_placeholder"]" autocomplete="on" type="text" id="booking-flight-arrival-airline" name="arrivalAirline0" class="form-control"
                                   v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').arrival_airlineName" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforFlight('arrivalFlightNo')">
                            <label>@Localizer["booking_step1_flight_info_flight_no"]<span class="text-danger">*</span></label>
                            <input placeholder="@Localizer["booking_step1_flight_info_flight_no_placeholder"]" autocomplete="on" type="text" id="booking-flight-arrival-flight-number" name="arrivalFlightNo0" class="form-control"
                                   v-model="booking.traffic.find(t=> t.traffic_type=='flight').arrival_flightNo" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforFlight('arrivalDate')">
                            <div class="form-group">
                                <label><!--@*航班抵達日期*@-->@Localizer["booking_step1_flight_info_arrival_date"]<span class="text-danger">*</span></label>
                                <input placeholder="@Localizer["booking_step1_flight_info_arrival_time_placeholder"]" autocomplete="on" type="text" id="booking-flight-departure-flight-number" name="departureFlightNo0" class="form-control"
                                       v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').arrival_date" required />
                            </div>
                        </div>
                        <div class="col-sm-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforFlight('arrivalTime')">
                            <div class="form-group">
                                <label><!--@*航班抵達時間*@-->@Localizer["booking_step1_flight_info_arrival_time"]<span class="text-danger">*</span></label>
                                <input placeholder="@Localizer["booking_step1_flight_info_departure_time_placeholder"]" autocomplete="on" type="text" id="booking-flight-departure-flight-number" name="departureFlightNo0" class="form-control"
                                       v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').arrival_time" required />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforFlight('arrivalVisa', 'Flight')">
                            <label><!--@*是否需要辦理落地簽證*@-->@Localizer["booking_step1_is_visa_required"]<span class="text-danger">*</span></label>
                            <div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="visa" id="visaT" value="1" required v-on:click="setArrivalVisa('1')"> @*v-model="booking?.traffic?.find(t=> t.traffic_type=='flight').arrival_visa"*@
                                    <label class="form-check-label" for="visaT">@Localizer["common_yes"]</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="visa" id="visaF" value="0" required v-on:click="setArrivalVisa('2')"> @*v-model="booking.traffic.find(t=> t.traffic_type=='flight').arrival_visa"*@
                                    <label class="form-check-label" for="visaF">@Localizer["common_no"]</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- @*租車資料*@  -->
            <template v-if="bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'rentcar_01' || t.trafficType?.trafficTypeValue == 'rentcar_02')">
                <div class="traveler-con traveler-other">
                    <div class="sub-title">
                        <!--@*租車資料*@-->@Localizer["booking_step1_rent_car"]
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforRentCar('slocation')">
                            <label><!--@*取車地點*@-->@Localizer["booking_step1_rent_car_pick_up_office"]<span class="text-danger">*</span></label>
                            <select class="form-control" @@change="changeRentLocation($event.target.value, 'pick')"
                                    v-model="booking?.traffic?.find(t=> t.traffic_type.startsWith('rentcar')).s_location" required>
                                <option value=""><!--@*請選擇取車地點*@-->@Localizer["booking_step1_rent_car_pick_up_office_placeholder"]</option>
                                <template v-for="temp in getBookingFieldReferenceforRentCar('slocation')">
                                    <option :value="temp.id" v-html="temp.name"></option>
                                </template>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforRentCar('sdate')">
                            <label><!--@*取車日期*@-->@Localizer["booking_step1_rent_car_pick_up_date"]<span class="text-danger">*</span></label>
                            <div class="input-group">
                                <input id="rentPickUpDate0" name="pickUpDate0" placeholder="@Localizer["booking_step1_rent_car_pick_up_date"]" type="text"
                                       v-model="booking?.traffic?.find(t=> t.traffic_type.startsWith('rentcar')).s_date" class="form-control has-datepicker" required>
                                <div class="input-group-append">
                                    <span class="input-group-text bg-white"><i class="icon-calendar icons"></i></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-4 col-xs-12 form-group" v-show="checkBookingFieldforRentCar('stime')">
                            <label><!--@*取車時間*@-->@Localizer["booking_step3_car_rentals_dep_time"]<span class="text-danger">*</span></label>
                            <select class="form-control"
                                    id="booking_pickup_time" v-model="booking?.traffic?.find(t=> t.traffic_type.startsWith('rentcar')).s_time" required>
                                <option value=""><!--@*請選擇取車地點*@-->@Localizer["booking_step1_rent_car_pick_up_office_placeholder"]</option>
                                @*<template v-for="temp in getBookingFieldReferenceforRentCar('sLocation')">
                                <option :value="temp.id" v-html="temp.name"></option>
                            </template>*@
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforRentCar('elocation')">
                            <label><!--@*還車地點*@-->@Localizer["booking_step1_rent_car_drop_off_office"]<span class="text-danger">*</span></label>
                            <select class="form-control" v-model="booking?.traffic?.find(t=> t.traffic_type.startsWith('rentcar')).e_location" @@change="changeRentLocation($event.target.value, 'drop')" required>
                                <option value=""><!--@*請選擇還車地點*@-->@Localizer["booking_step1_rent_car_drop_off_office_placeholder"]</option>
                                <template v-for="temp in getBookingFieldReferenceforRentCar('elocation')">
                                    <option :value="temp.id" v-html="temp.name"></option>
                                </template>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6  col-xs-12 form-group" v-show="checkBookingFieldforRentCar('edate')">
                            <label><!--@*還車日期*@-->@Localizer["booking_step1_rent_car_drop_off_date"]<span class="text-danger">*</span></label>
                            <div class="input-group" name="rentDropOffDate0">
                                <input name="dropOffDate0" v-model="booking?.traffic?.find(t=> t.traffic_type.startsWith('rentcar')).e_date"
                                       placeholder="@Localizer["booking_step1_rent_car_drop_off_date_placeholder"]" type="text" class="form-control has-datepicker" required>
                                <div class="input-group-append">
                                    <span class="input-group-text bg-white"><i class="icon-calendar icons"></i></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-4 col-xs-12 form-group" v-show="checkBookingFieldforRentCar('etime')">
                            <label><!--@*還車時間*@-->@Localizer["booking_step1_rent_car_drop_off_time"]<span class="text-danger">*</span></label>
                            <select id="booking_dropoff_time" name="dropOffTime0" class="form-control" v-model="booking?.traffic?.find(t=> t.traffic_type.startsWith('rentcar')).e_time" required>
                                <option value=""> -- </option>
                            </select>
                            @*<template v-for="temp in getBookingFieldReferenceforRentCar('eLocation')">
                            <option :value="temp.id" v-html="temp.name"></option>
                        </template>*@
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6  col-xs-12 form-group" v-show="checkBookingFieldforRentCar('provideWifi')">
                            <label><!--@*是否需要免費Wifi機*@-->是否需要免費Wifi機<span class="text-danger">*</span></label>
                            <div class="form-inline radio-has-son">
                                <label>
                                    <input type="radio" name="has_wifi" value="true" v-on:click="setWifi('1')"> 需要
                                </label><label>
                                    <input type="radio" name="has_wifi" value="false" v-on:click="setWifi('2')"> 不需要
                                </label>
                            </div> <div class="form-group-son form-group must"></div>
                        </div>
                        <div class="col-md-4 col-sm-4 col-xs-12 form-group" v-show="checkBookingFieldforRentCar('provideGps')">
                            <label><!--@*是否需要免費GPS*@-->是否需要免費GPS<span class="text-danger">*</span></label>
                            <div class="form-inline radio-has-son">
                                <label>
                                    <input type="radio" name="has_gps" value="true" v-on:click="setGps('1')"> 需要
                                </label><label>
                                    <input type="radio" name="has_gps" value="false" v-on:click="setGps('2')"> 不需要
                                </label>
                            </div> <div class="form-group-son form-group must"></div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- @*接駁資料*@  -->
            <template v-if="bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'pickup_03')">
                <div class="traveler-con traveler-other">
                    <div class="sub-title">
                        <!--@*接駁資料*@-->@Localizer["booking_step1_pick_up_03"]
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforPickUp('sdate')">
                            <label><!--@*接駁日期*@-->@Localizer["booking_step1_rent_car_pick_up_03_date"]<span class="text-danger">*</span></label>
                            <div class="input-group">
                                <input id="rentPickUpDate0" name="pickUpDate0" placeholder="@Localizer["booking_step1_rent_car_pick_up_date"]" type="text"
                                       v-model="booking?.traffic?.find(t=> t.traffic_type.startsWith('pickup')).s_date" class="form-control has-datepicker" required>
                                <div class="input-group-append">
                                    <span class="input-group-text bg-white"><i class="icon-calendar icons"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforPickUp('slocation')">
                            <label>gg<!--@*接駁地點*@-->@Localizer["booking_step1_rent_car_pick_up_03_office_placeholder"]<span class="text-danger">*</span></label>
                            <select class="form-control" @@change="changeRentLocation($event.target.value, 'pick')"
                                    v-model="booking?.traffic?.find(t=> t.traffic_type.startsWith('pickup')).s_location" required>
                                <option value=""><!--@*請選擇接駁地點點*@-->@Localizer["booking_step1_rent_car_pick_up_office_placeholder"]</option>
                                <template v-for="temp in getBookingFieldReferenceforRentCar('slocation')">
                                    <option :value="temp.id" v-html="`${temp.name}${temp.sTime}~${temp.eTime}`"></option>
                                </template>
                            </select>
                        </div>
                    </div>
                </div>
            </template>

            <!--@*接送資料*@-->
            <template v-if="bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'rentcar_03' || t.trafficType?.trafficTypeValue == 'pickup_04') ">
                <div class="traveler-con traveler-other">
                    <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforRentCar('sdate')">
                        <label><!--@*接送日期*@-->@Localizer["booking_step1_shuttle_data_pick_up_time"]<span class="text-danger">*</span></label>
                        <div class="input-group">
                            <input id="rentPickUpDate0" name="pickUpDate0" placeholder="@Localizer["booking_step1_rent_car_pick_up_date"]" type="text"
                                   v-model="booking?.traffic?.find(t=> t.traffic_type.startsWith('rentcar') || t.traffic_type.startsWith('pickup') ).s_date" class="form-control has-datepicker" required>
                            <div class="input-group-append">
                                <span class="input-group-text bg-white"><i class="icon-calendar icons"></i></span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforRentCar('stime')">
                            <label><!--@*接送時間*@-->@Localizer["booking_step1_shuttle_data_pick_up_time"]<span class="text-danger">*</span></label>
                            <select id="booking-shuttle-time" class="form-control" name="shuttlePickUpTime0" @@change="changeShuttleTime($event.target.value)" required>
                                <option value=""><!--@*請選擇接送時間*@-->@Localizer["booking_step1_shuttle_data_pick_up_time_placeholder"]</option>
                                <template v-for="pk in getBookingFieldReferenceforRentCar('stime')">
                                    <option :value="`${pk.hour}:${pk.min}`" v-html="`${pk.hour}:${pk.min}`" v-if="pk.hour !=0"></option>
                                </template>
                                <template v-for="pk in bookingField.traffics.find(t =>t.trafficType?.trafficTypeValue=='pickup_04').stime.listOption ? bookingField.traffics.find(t =>t.trafficType?.trafficTypeValue=='pickup_04').stime.listOption.filter(t => t.timeRange) : []">
                                    <option value="customize" :data-range="pk.timeRange"><!--@*自訂接送時間*@-->@Localizer["booking_step1_shuttle_data_customized_shuttle_time"]</option>
                                </template>
                            </select>
                        </div>
                        <div class="col-sm-3  col-xs-12 form-group" v-show="show_cus_shuttle">
                            <label><!--@*自訂接送時間*@-->@Localizer["booking_step1_shuttle_data_customized_shuttle_time"]<span class="text-danger">*</span></label>
                            <select x-ref="shuttle_cus_time" id="booking-shuttle-cus-time" name="pickUpCusTime" class="form-control" v-model="booking.traffic.find(t=> t.traffic_type.startsWith('pickup')).s_time" required>
                                <option disabled="disabled" value="">--</option>
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-12 form-group" v-show="checkBookingFieldforRentCar('slocation')">
                            <label><!--@*上車地點*@-->@Localizer["booking_step1_shuttle_data_pick_up_location"]<span class="text-danger">*</span></label>
                            <textarea id="booking-shuttle-pickup-location" placeholder="@Localizer["booking_step1_shuttle_data_pick_up_location_placeholder"]" name="pickUpLocation0" rows="2" class="form-control"
                                      v-model="booking.traffic.find(t=>t.traffic_type.startsWith('pickup')).s_location" required></textarea>
                        </div>
                        <div class="col-md-6 col-sm-12 form-group" v-show="checkBookingFieldforRentCar('elocation')">
                            <label><!--@*下車地點*@-->@Localizer["booking_step1_shuttle_data_drop_off_location"]<span class="text-danger">*</span></label>
                            <textarea id="booking-shuttle-dropoff-location" placeholder="@Localizer["booking_step1_shuttle_data_drop_off_location_placeholder"]" name="dropOffLocation0" rows="2" class="form-control"
                                      v-model="booking.traffic.find(t=>t.traffic_type.startsWith('pickup')).e_location" required></textarea>
                        </div>
                    </div>
                    <div class="row" v-show="bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'rentcar_03')">
                        <div class="col-md-6 col-sm-12 form-group">
                            <label><!--@*包車路線*@-->@Localizer["booking_step1_shuttle_data_charter_route"]<span class="text-danger">*</span></label>
                            <select id="booking-shuttle-route" class="form-control" name="charterRoute0" @@change="changeShuttleRoute($event.target.value)"
                                    required>
                                @*v-model="booking?.traffic?.find(t=> t.traffic_type.startsWith('rentcar')).s_location"*@
                                <option disabled="disabled" value="">
                                    <!--@*請選擇包車路線*@-->@Localizer["booking_step1_shuttle_data_charter_route_placeholder"]
                                </option>
                                <template v-for="temp in getBookingFieldReferenceforRentCar('slocation')">
                                    <option :value="temp.id" v-html="temp.routeLocal"></option>
                                </template>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-12 form-group" v-show="show_cus_route">
                        <div class="form-group">
                            <label><!--@*自訂行程*@-->@Localizer["booking_step1_shuttle_data_custom_routes"]<span class="text-danger">*</span></label>
                            <div class="d-flex">
                                <input placeholder="@Localizer["booking_step1_shuttle_data_custom_routes_placeholder"]" autocomplete="on" type="text" id="booking-shuttle-custom-route" class="form-control flex-grow-1">
                                <a class="btn btn-primary btn-next ml-2 text-white" style="flex-basis: 50px;" @@click="addCusRoute()"> <!--增加--> @Localizer["common_add"]</a>
                            </div>
                            <div class="tip kk-u-text-dark"> @Localizer["booking_step1_shuttle_data_custom_routes_note_1"] <span>2</span> @Localizer["booking_step1_shuttle_data_custom_routes_note_2"] </div>
                            <div class="d-flex flex-row mt-3 cus-route-wrapper">
                                <template v-for="(item, idx) in booking_custom_routes">
                                    <div class="cus-route-item  mr-2"><span v-html="item"></span> <i class="ri-close-line" @@click="removeCusRoute(idx)"></i></div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!--@*乘客資料*@-->
            <template v-if="bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue =='psg_qty') ">
                <div class="traveler-con traveler-other">
                    <div class="sub-title">
                        <!--@*乘客資料標題*@-->@Localizer["booking_step1_car_psgr"]
                    </div>
                    <div class="passenger-group">
                        <span class="passenger-group-title"><!--乘客數量-->@Localizer["booking_step1_car_psgr_custom_quantity"]</span>
                        <div class="row">
                            <div class="col-sm-4 col-xs-12">
                                <div>
                                    <small><!--@*成人 (1 - 99 歲)*@-->@Localizer["common_adult"] @Localizer["common_years_old"]</small>
                                    <div class="form-group">
                                        <select id="booking-passenger-quantity-adult-0" name="booking-passenger-quantity-adult-0" class="form-control" v-model="booking.traffic.find(t=>t.traffic_type.startsWith('psg_qty')).carpsg_adult" required>
                                            <option value="" disabled="disabled"> -- </option>
                                            <option value="0">0</option>
                                            <template v-for="idx in 30">
                                                <option :value="idx.toString()" v-html="idx"></option>
                                            </template>
                                        </select>
                                    </div>
                                </div>
                            </div><div class="col-sm-4 col-xs-12">
                                <div>
                                    <small><!--@*孩童 (1 - 99 歲)*@-->@Localizer["common_child"] @Localizer["common_years_old"]</small>
                                    <div class="form-group">
                                        <select id="booking-passenger-quantity-child-0" name="booking-passenger-quantity-child-0" class="form-control" v-model="booking.traffic.find(t=>t.traffic_type.startsWith('psg_qty')).carpsg_child" required>
                                            <option value="" disabled="disabled"> -- </option>
                                            <option value="0">0</option>
                                            <template v-for="idx in 30">
                                                <option :value="idx.toString()" v-html="idx"></option>
                                            </template>
                                        </select>
                                    </div>
                                </div>
                            </div><div class="col-sm-4 col-xs-12">
                                <div>
                                    <small><!--@*嬰幼兒 (1 - 99 歲)*@-->@Localizer["common_infant"] @Localizer["common_years_old"]</small>
                                    <div class="form-group">
                                        <select id="booking-passenger-quantity-infant-0" name="booking-passenger-quantity-infant-0" class="form-control" v-model="booking.traffic.find(t=>t.traffic_type.startsWith('psg_qty')).carpsg_infant" required>
                                            <option value="" disabled="disabled"> -- </option>
                                            <option value="0">0</option>
                                            <template v-for="idx in 30">
                                                <option :value="idx.toString()" v-html="idx"></option>
                                            </template>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="passenger-group">
                        <span class="passenger-group-title"><!--@*行李數量*@-->@Localizer["booking_step1_car_psgr_carry_luggage_quantity"]</span>
                        <div class="row">
                            <div class="col-sm-4 col-xs-12">
                                <div>
                                    <small><!--@*手提行李 (20吋以下)*@-->@Localizer["booking_step1_car_psgr_carry_luggage"]</small>
                                    <div class="form-group">
                                        <select id="booking-passenger-quantity-luggage-carry-0" name="booking-passenger-quantity-luggage-carry-0" class="form-control"
                                                v-model="booking.traffic.find(t=>t.traffic_type.startsWith('psg_qty')).luggage_carry" required>
                                            <option value="" disabled="disabled"> -- </option>
                                            <option value="0">0</option>
                                            <template v-for="idx in 30">
                                                <option :value="idx.toString()" v-html="idx"></option>
                                            </template>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4 col-xs-12">
                                <div>
                                    <small><!--@*托運行李 (21吋以上)*@-->@Localizer["booking_step1_car_psgr_checked_luggage"]</small>
                                    <div class="form-group">
                                        <select id="booking-passenger-quantity-luggage-checked-0" name="booking-passenger-quantity-luggage-checked-0" class="form-control"
                                                v-model="booking.traffic.find(t=>t.traffic_type.startsWith('psg_qty')).luggage_check" required>
                                            <option value="" disabled="disabled"> -- </option>
                                            <option value="0">0</option>
                                            <template v-for="idx in 30">
                                                <option :value="idx.toString()" v-html="idx"></option>
                                            </template>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="passenger-group">
                        <span class="passenger-group-title">
                            <!--@*兒童座椅數量 (適用年齡 1 - 99 歲)*@-->@Localizer["booking_step1_car_psgr_child_seat_quantity"]
                        </span>
                        <div class="row">
                            <div class="col-sm-4 col-xs-12">
                                <div>
                                    <small><!--@*店家提供*@-->@Localizer["booking_step1_car_psgr_supplier_provided"]</small>
                                    <div class="form-group">
                                        <select id="booking-passenger-quantity-childseat-supplier-0" name="booking-passenger-quantity-childseat-supplier-0" class="form-control"
                                                v-model="booking.traffic.find(t=>t.traffic_type.startsWith('psg_qty')).safetyseat_self_child" required>
                                            <option value="" disabled="disabled"> -- </option>
                                            <option value="0">0</option>
                                            <template v-for="idx in 10">
                                                <option :value="idx.toString()" v-html="idx"></option>
                                            </template>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-4 col-xs-12">
                                <div>
                                    <small><!--@*自備座椅*@-->@Localizer["booking_step1_car_psgr_self_provided"]</small>
                                    <div class="form-group">
                                        <select id="booking-passenger-quantity-childseat-customer-0" name="booking-passenger-quantity-childseat-customer-0" class="form-control"
                                                v-model="booking.traffic.find(t=>t.traffic_type.startsWith('psg_qty')).safetyseat_sup_child" required>
                                            <option value="" disabled="disabled"> -- </option>
                                            <option value="0">0</option>
                                            <template v-for="idx in 10">
                                                <option :value="idx.toString()" v-html="idx"></option>
                                            </template>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="passenger-group">
                        <span class="passenger-group-title">
                            <!--@*嬰兒座椅數量  (適用年齡 1 - 99 歲)*@-->@Localizer["booking_step1_car_psgr_infant_seat_quantity"]
                        </span> <div class="row">
                            <div class="col-sm-4 col-xs-12">
                                <div>
                                    <small><!--@*店家提供*@-->@Localizer["booking_step1_car_psgr_supplier_provided"]</small> <div class="form-group">
                                        <select id="booking-passenger-quantity-infantseat-supplier-0" name="booking-passenger-quantity-infantseat-supplier-0" class="form-control"
                                                v-model="booking.traffic.find(t=>t.traffic_type.startsWith('psg_qty')).safetyseat_sup_infant" required>
                                            <option value="" disabled="disabled"> -- </option>
                                            <option value="0">0</option>
                                            <template v-for="idx in 10">
                                                <option :value="idx.toString()" v-html="idx"></option>
                                            </template>
                                        </select>
                                    </div>
                                </div>
                            </div><div class="col-sm-4 col-xs-12">
                                <div>
                                    <small><!--@*自備座椅*@-->@Localizer["booking_step1_car_psgr_self_provided"]</small>
                                    <div class="form-group">
                                        <select name="booking-passenger-quantity-infantseat-customer-0" class="form-control"
                                                v-model="booking.traffic.find(t=>t.traffic_type.startsWith('psg_qty')).safetyseat_self_infant" required>
                                            <option value="" disabled="disabled">--</option>
                                            <option value="0">0</option>
                                            <template v-for="idx in 10">
                                                <option :value="idx.toString()" v-html="idx"></option>
                                            </template>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- @*寄送資料*@ -->
            <template v-if="bookingField?.custom?.cusType?.listOption?.indexOf('send')>-1">
                <div class="traveler-con">
                    <div class="sub-title">
                        <!--@*寄送資料標題*@-->@Localizer["booking_step1_send_data"]
                    </div>

                    <div class="row mb-4">
                        <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingField('custom.nativeFirstName', 'send')">
                            <div class="form-group">
                                <label><!--@*收件人名*@-->@Localizer["booking_step1_send_data_receiver_firstname"]<span class="text-danger">*</span></label>
                                <input type="text" name="receiverFirstName" class="form-control" v-model="booking.send.native_first_name" placeholder="@Localizer["booking_step1_local_firstname_placeholder"]" required>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingField('custom.nativeLastName', 'send')">
                            <div class="form-group">
                                <label><!--@*收件人姓*@-->@Localizer["booking_step1_send_data_receiver_lastname"]<span class="text-danger">*</span></label>
                                <input type="text" name="receiverLastName" class="form-control" v-model="booking.send.native_last_name" placeholder="@Localizer["booking_step1_local_lastname_placeholder"]" required>
                            </div>
                        </div>
                        <!-- Send Tel -->
                        <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingField('custom.telNumber', 'send')">
                            <div class="form-group">
                                <label><!--@*收件人電話*@-->@Localizer["booking_step1_send_data_receiver_tel"]<span class="text-danger">*</span></label>
                                <div class="input-group buyer-tel-country">
                                    <select name="send_tel_number" class="form-control" v-model="booking.send.tel_country_code" required>
                                        <option value="">@Localizer["booking_step1_send_data_receiver_tel_placeholder"]</option>
                                        <template v-for="tel in getBookingFieldReference('custom.telCountryCode')">
                                            <option :value="tel.code" v-html="`${tel.info} ${tel.code}`"></option>
                                        </template>
                                    </select>
                                    <input placeholder="@Localizer["component_form_contact_tel_placeholder"]" type="tel" class="form-control form-phone" name="tel_number" v-model="booking.send.tel_number" autocomplete="off" required>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--@*收件地址*@-->
                    <div class="row" v-show="checkBookingField('custom.countryCities', 'send')">
                        <div class="col-12 mb-2"><!--@*收件人地址*@-->@Localizer["booking_step1_send_data_receive_address"]</div>
                        <div class="col-md-4 col-sm-6 col-xs-12">
                            <div class="form-group">
                                <small><!--@*收件國家/地區*@-->@Localizer["booking_step1_send_data_receive_address_country"]</small><span class="text-danger">*</span>
                                <select name="receiverCountry" id="receiverCountry" class="form-control" @@change="setCountry($refs.receiver_city, $event.target.value)" required>
                                    <option value="">@Localizer["common_select_set"]</option>
                                    <template v-for="na in getBookingFieldReference('custom.countryCities')">
                                        <option :value="na.id" v-html="na.name"></option>
                                    </template>
                                </select>
                            </div>
                        </div>
                        <!--@*收件城市*@-->
                        <div class="col-md-4 col-sm-6 col-xs-12">
                            <div class="form-group">
                                <small><!--@*收件城市(不在列表中請選其他城市)*@-->@Localizer["booking_step1_send_data_receive_address_city"]</small><span class="text-danger">*</span>
                                <select ref="receiver_city" class="form-control" id="receiverCity" name="receiverCity" required>
                                    <option value="">@Localizer["common_select_set"]</option>
                                </select>
                            </div>
                        </div>
                        <!--@*收件郵遞區號*@-->
                        <div class="col-md-4 col-sm-6 col-xs-12" v-show="checkBookingField('custom.zipCode', 'send')">
                            <div class="form-group">
                                <small><!--@*郵遞區號(港澳區請填0)*@-->@Localizer["booking_step1_send_data_zip_colde"]</small><span class="text-danger">*</span>
                                <input id="booking-send-data-receiver-postalcode" name="postal0" type="text" v-model="booking.send.zipcode" class="form-control" required />
                            </div>
                        </div>
                        <!--@*收件地址*@-->
                        <div class="col-md-6 col-sm-12 col-xs-12" v-show="checkBookingField('custom.address', 'send')">
                            <div class="form-group">
                                <small><!--@*詳細地址*@-->@Localizer["booking_step1_send_data_receive_address_detail"]</small><span class="text-danger">*</span>
                                <textarea placeholder="@Localizer["booking_step1_send_data_receive_address_placeholder"]" name="receiverAddress0" rows="2" class="form-control" v-model="booking.send.address" required></textarea>
                            </div>
                        </div>

                    </div>
                    <!-- Hotel -->
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.hotelName', 'send')">
                            <label>寄送飯店名稱<span class="text-danger">*</span></label>
                            <input placeholder="請輸入寄送飯店名稱" autocomplete="on" type="text" id="booking-send-data-hotel-name" name="hotelName0" class="form-control" v-model="booking.send.hotel_name" />
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.hotelTelNumber', 'send')">
                            <label>飯店電話<span class="text-danger">*</span></label>
                            <input placeholder="請輸入飯店電話" autocomplete="on" type="tel" id="booking-send-data-hotel-tel" name="hotelTel0" class="form-control" v-model="booking.send.hotel_tel_number" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.address', 'send')">
                            <label>飯店地址<span class="text-danger">*</span></label>
                            <textarea id="booking-send-data-hotel-address" placeholder="請輸入寄送飯店地址" name="hotelAddress0" rows="2" class="form-control"></textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.englishFirstName', 'send')">
                            <label>訂房人英文名(同護照)<span class="text-danger">*</span></label>
                            <input placeholder="例：Ming Ni" autocomplete="on" type="text" id="booking-send-data-booker-english-lastname" name="sendPassportFirstName0" class="form-control" v-model="booking.send.english_first_name" />
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.englishLastName', 'send')">
                            <label>訂房人英文姓(同護照)<span class="text-danger">*</span></label>
                            <input placeholder="例：Chan" autocomplete="on" type="text" id="booking-send-data-booker-english-firstname" name="sendPassportLastName0" class="form-control" v-model="booking.send.english_last_name" />
                        </div>
                    </div>
                    @* <div class="row">
                    <div class="col-md-6 col-sm-6 col-xs-12 form-group">
                        <label>訂房人名<span class="text-danger">*</span></label>
                        <input placeholder="例：品睿" autocomplete="on" type="text" id="booking-send-data-booker-local-firstName" name="buyerLocalFirstName0" class="form-control" v-model="booking.send.local_last_name" />
                    </div>
                    <div class="col-md-6 col-sm-6 col-xs-12 form-group">
                        <label>訂房人姓<span class="text-danger">*</span></label>
                        <input placeholder="例：陳" autocomplete="on" type="text" id="booking-send-data-booker-local-lastName" name="buyerLocalLastName0" class="form-control" v-model="booking.send.local_first_name" />
                    </div>
                </div>*@
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.bookingWebsite', 'send')">
                            <label>訂房網站<span class="text-danger">*</span></label>
                            <input placeholder="請輸入訂房網站" autocomplete="on" type="text" id="booking-send-data-booking-website" name="bookingWebsite0" class="form-control" v-model="booking.send.booking_website">
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.bookingOrderNo', 'send')">
                            <label>訂房編號<span class="text-danger">*</span></label>
                            <input placeholder="請輸入訂房編號" autocomplete="on" type="text" id="booking-send-data-booking-number" name="bookingOrderNo0" class="form-control" v-model="booking.send.booking_order_no" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.checkInDate', 'send')">
                            <label>入住日期<span class="text-danger">*</span></label>
                            <div class="input-group" name="checkInDate0">
                                <input id="booking-send-data-checkin-date" v-model="booking.send.check_in_date" placeholder="請選擇入住日期" type="text" class="form-control has-datepicker">
                                <div class="input-group-append">
                                    <span class="input-group-text bg-white"><i class="icon-calendar icons"></i></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingField('custom.checkOutDate', 'send')">
                            <label>退房日期<span class="text-danger">*</span></label>
                            <div class="input-group" name="checkOutDate0">
                                <input id="booking-send-data-checkout-date" v-model="booking.send.check_out_date" placeholder="請選擇退房日期" type="text" class="form-control has-datepicker">
                                <div class="input-group-append">
                                    <span class="input-group-text bg-white"><i class="icon-calendar icons"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- @*其他 Mobile Device*@ -->
            <template v-if="bookingField?.mobile_device">
                <div class="traveler-con traveler-other">
                    <div class="sub-title">
                        <!--@*其他資料*@-->@Localizer["booking_step1_other_data"]
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="bookingField?.mobile_device?.mobileModelNo?.isRequire=='True'">
                            <label><!--@*手機型號*@-->@Localizer["booking_step1_other_data_mobile_model_number"]<span class="text-danger">*</span></label>
                            <input placeholder="@Localizer["booking_step1_other_data_mobile_model_number_placeholder"]" autocomplete="on" type="text" name="booking-other-mobile-no" class="form-control" v-model="booking.mobile_device.mobile_model_no" required>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="bookingField?.mobile_device?.imei?.isRequire=='True'">
                            <label>IMEI<span class="text-danger">*</span></label>
                            <input placeholder="@Localizer["booking_step1_other_data_imei_placeholder"]" autocomplete="on" type="text" name="booking-other-mobile-imei" class="form-control"
                                   minlength="15" maxlength="15" oninput="this.value=this.value.replace(/[^\d]/g, '')" v-model="booking.mobile_device.IMEI" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="bookingField?.mobile_device?.activeDate?.isRequire=='True'">
                            <div class="form-group">
                                <label><!--@*開通日期*@-->@Localizer["booking_step1_other_data_activation_date"]<span class="text-danger">*</span></label>
                                <input placeholder="@Localizer["booking_step1_other_data_activation_date_placeholder"]" autocomplete="on" type="text" id="booking-flight-departure-flight-number" name="departureFlightNo0" class="form-control"
                                       v-model="booking.mobile_device.active_date" required />
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- @*取票櫃檯 *@ -->
            <template v-if="bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'voucher')">
                <div class="traveler-con traveler-other">
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12 form-group" v-show="checkBookingFieldforRentCar('slocation')">
                            <label><!--@*取車地點*@-->@Localizer["booking_step1_voucher_info_voucher_counter"]<span class="text-danger">*</span></label>
                            <select class="form-control"
                                    v-model="booking?.traffic?.find(t=> t.traffic_type.startsWith('voucher')).s_location" required>
                                <option value=""><!--@*請選擇取車地點*@-->@Localizer["booking_step1_rent_car_pick_up_office_placeholder"]</option>
                                <template v-for="temp in getBookingFieldReferenceforRentCar('slocation')">
                                    <option :value="temp.id" v-html="temp.name"></option>
                                </template>
                            </select>
                        </div>
                    </div>
                </div>
            </template>

            <!-- @*旅遊期間聯絡方式*@ -->
            <template v-if="bookingField?.custom?.cusType?.listOption?.indexOf('contact')>-1">
                <div class="traveler-con">
                    <div class="sub-title"><!--@*旅遊期間聯絡方式標題*@-->@Localizer["booking_step1_contact_data"]</div>

                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingField('custom.nativeFirstName', 'contact')">
                            <div class="form-group">
                                <label><!--@*聯絡人名*@-->@Localizer["booking_step1_contact_data_firstname"]<span class="text-danger">*</span></label>
                                <input name="contactFisrtName" placeholder="@Localizer["booking_step1_cust_data_passport_english_firstname_placeholder"]" type="text" class="form-control" v-model="booking.contact.native_first_name" required>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingField('custom.nativeLastName', 'contact')">
                            <div class="form-group">
                                <label><!--@*聯絡人姓*@-->@Localizer["booking_step1_send_data_receiver_lastname"]<span class="text-danger">*</span></label>
                                <input name="contactLastName" placeholder="@Localizer["booking_step1_contact_data_lastname_placeholder"]" type="text" class="form-control" v-model="booking.contact.native_last_name" required>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingField('custom.telNumber', 'contact')">
                        <div class="form-group">
                            <label><!--@*旅遊期間聯絡電話*@-->@Localizer["booking_step1_contact_data_contact_tel"]@*<span class="text-danger">*</span>*@</label>
                            <div class="form-inline radio-has-son">
                                <label>
                                    <input type="radio" name="has_contact_tel" value="true" @@click="show_travel_contact_phone=true"> @Localizer["common_have"]
                                </label><label>
                                    <input type="radio" name="has_contact_tel" value="false" @@click="show_travel_contact_phone=false"> @Localizer["common_have_not"]
                                </label>
                            </div> <div class="form-group-son form-group must"></div>
                        </div>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6 col-sm-6 col-xs-12" v-show="show_travel_contact_phone">
                        <div class="form-group">
                            <label><!--@*聯絡電話*@-->@Localizer["component_form_contact_tel_title"]<span class="text-danger">*</span></label>
                            <div class="input-group buyer-tel-country">
                                <select name="contact_tel_country_code" class="form-control" v-model="booking.contact.tel_country_code" required
                                        data-bv-callback="true" data-bv-callback-message="@Localizer["KHSR_Booking_Error_tw_gender_unmatch"]" data-bv-callback-callback="BvCheckGenderWithTWID">
                                    <option value="">@Localizer["component_form_gender_placeholder"]</option>
                                    <template v-for="tel in getBookingFieldReference('custom.telCountryCode')">
                                        <option :value="tel.code" v-html="`${tel.info} ${tel.code}`"></option>
                                    </template>
                                </select>
                                <input placeholder="@Localizer["component_form_contact_tel_placeholder"]" type="tel" class="form-control form-phone" name="contact_tel_number" v-model="booking.contact.tel_number" autocomplete="off" required>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 col-sm-6 col-xs-12" v-show="checkBookingField('custom.contactApp', 'contact')">
                        <div class="form-group">
                            <label><!--@*APP聯絡方式*@-->@Localizer["booking_step1_contact_data_contact_app"]@*<span class="text-danger">*</span>*@</label>
                            <div class="form-inline radio-has-son">
                                <label>
                                    <input type="radio" name="has_contact_app" value="true" @@click="show_travel_contact_app=true" required> @Localizer["common_have"]
                                </label>
                                <label>
                                    <input type="radio" name="has_contact_app" value="false" @@click="show_travel_contact_app=false" required> @Localizer["common_have_not"]
                                </label>
                            </div>
                            <div class="form-group-son form-group must"></div>
                        </div>
                    </div>
                </div>
                <div class="row" v-show="show_travel_contact_app">
                    <div class="col-md-6 col-sm-6 col-xs-12 form-group">
                        <label><!--@*可聯繫 APP*@-->@Localizer["booking_step1_contact_data_contact_app_maybe"]<span class="text-danger">*</span></label>
                        <select id="booking-contact-app-type" class="form-control" name="appType0" v-model="booking.contact.contact_app" required>
                            <option disabled="disabled" value="">@Localizer["booking_step1_contact_data_contact_app_placeholder"]</option>
                            <template v-for="app in getBookingFieldReference('custom.contactApp')">
                                <option :value="app.appType" v-html="app.appName" v-if="app.supported==true"></option>
                            </template>
                        </select>
                    </div>
                    <div class="col-md-6 col-sm-6 col-xs-12 form-group">
                        <label><!--@*APP 帳號*@-->@Localizer["booking_step1_contact_data_contact_app_account"]<span class="text-danger">*</span></label>
                        <input name="appAccount0" placeholder="@Localizer["common_text_field_set"]" autocomplete="on" type="text" id="booking-contact-app-account" class="form-control" v-model="booking.contact.contact_app_account" required>
                    </div>
                </div>
            </template>
        </div>
        <div>
            <input type="button" class="btn btn-primary" v-on:click="toBooking()" value="submit"></input>
        </div>
    </div>
</div>

<div id="App1">
    <div class="container">
        <div class="row">
            <div id="booking_html" class="col-12">
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">let app = new Vue({
        el: '#App',
        data() {
            return {
                isLoading: false,
                prod_no: null,
                pkg_no: null,
                country_cities: [],
                country_areas: [],
                booking: {},
                bookingField: {},
                show_travel_contact_app: false,
                show_travel_contact_phone: false,
                show_cus_route: false,
                show_cus_shuttle:false,
                booking_custom_routes: []
            }
        },
        created: function () {
            this.Query();
            this.show_travel_contact_app = this.checkBookingField('custom.contactApp', 'contact');
            this.show_travel_contact_phone = this.checkBookingField('custom.telNumber', 'contact');
        },
        methods: {
            Query() {
                if (this.isLoading) {
                    return;
                }

                // Load country-info
                fetch(`${_root_path}Common/QueryCountryInfo/@locale`)
                    .then(response => response.json())
                    .then(data => {
                        // console.log(`countries => ${JSON.stringify(data)}`);
                        this.country_cities = data.countries;
                        this.country_areas = data.country_areas;
                    });

                this.isLoading = true;
                setTimeout(() => {
                    this.Fetch();
                }, 100)
            },
            Fetch() {
                let req = localStorage.getItem("bookingReq");
                // localStorage.removeItem("bookingReq");
                //console.log(`Fetch Req => ${req}`);
                var reqObj = JSON.parse(req);
                this.prod_no = reqObj.prod_no;
                this.pkg_no = reqObj.pkg_no;
                let uri = `${_root_path}Booking/LoadData`;
                fetch(uri, {
                    method: 'POST',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    body: req // JSON.stringify(req)
                })
                    .then(response => {
                        // console.log(response.status);
                        return response.json()
                    })
                    .then(result => {
                        console.log(`${JSON.stringify(result)}`);

                        $('#booking_html').text(JSON.stringify(result.bookingmodel));
                        this.booking = result.bookingmodel;
                        this.bookingField = result.bookingfield;

                        this.isLoading = false;
                    })
                    .catch(error => { console.error('Unable to search.', error); this.isLoading = false });

            },
            checkBookingField(path, keys, mandatory) {
                try {
                    //debugger;
                    getValue = (o, p) => p.split('.').reduce((r, k) => r[k], o);

                    let key_array = keys.split(',');

                    let is_required = getValue(this.bookingField, path + '.isRequire');
                    if (mandatory === false) {
                        //@* console.log(`path: ${path} (${keys}) => optional : ${(IsRequire === false) }`); *@
                        return (is_required === false);
                    }
                    if (keys == 'cus_01,cus_02') {

                        var result = is_required == "True" ? true : false;
                        return result;
                    }
                    else if (keys == 'contact') {
                        let is_contact_used = getValue(this.bookingField, path + '.isContactUsed');
                        var result = is_required == "True" && is_contact_used == "True" ? true : false;
                        return result;
                    }
                    else if (keys == 'send') {
                        let is_send_used = getValue(this.bookingField, path + '.isSendUsed');
                        var result = is_required == "True" && is_send_used == "True" ? true : false;
                        return result;
                    }

                    //let result = (using && is_required === "True") ? using.filter(v => key_array.includes(v)).length > 0 : false;
                    //@* console.log(`path: ${path}  ${JSON.stringify(key_array)} => using: ${JSON.stringify(using)}/matched=${using.filter(v => key_array.includes(v)).length}, is_required: ${is_required} => ${result}`); *@
                    //return result;
                } catch (e) {
                    //@* console.log(`path: ${path} (${keys}) => error : ${e}`); *@
                    return false;
                }
            },
            checkBookingFieldforFlight(path) {
                try {
                    //debugger;
                    let flight = this.bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'flight');
                    getValue = (o, p) => p.split('.').reduce((r, k) => r[k], o);

                    //要確認要不要加  is_flight_used 
                    let is_required = getValue(flight, path + '.isRequire');
                    var result = is_required == "True" ? true : false;
                    return result;

                    //let result = (using && is_required === "True") ? using.filter(v => key_array.includes(v)).length > 0 : false;
                    //@* console.log(`path: ${path}  ${JSON.stringify(key_array)} => using: ${JSON.stringify(using)}/matched=${using.filter(v => key_array.includes(v)).length}, is_required: ${is_required} => ${result}`); *@
                    //return result;
                } catch (e) {
                    //@* console.log(`path: ${path} (${keys}) => error : ${e}`); *@
                    return false;
                }
            },
            checkBookingFieldforRentCar(path) {
                try {
                    //debugger;
                    let flight = this.bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'rentcar_01' || t.trafficType?.trafficTypeValue == 'rentcar_02' || t.trafficType?.trafficTypeValue == 'rentcar_03' || t.trafficType?.trafficTypeValue == 'pickup_03' || t.trafficType?.trafficTypeValue == 'pickup_04' || t.trafficType?.trafficTypeValue == 'voucher');
                    if (flight == undefined) { return false; }
                    getValue = (o, p) => p.split('.').reduce((r, k) => r[k], o);

                    //要確認要不要加  is_flight_used
                    let is_revisible = getValue(flight, path + '.isVisible');
                    let is_required = getValue(flight, path + '.isRequire');
                    if (path.indexOf('provide') == -1) {
                        var result = is_required == "True" ? true : false;
                        return result;
                    }
                    else {
                        var result = is_revisible  == "True" ? true : false;
                        return result;
                    }

                    //let result = (using && is_required === "True") ? using.filter(v => key_array.includes(v)).length > 0 : false;
                    //@* console.log(`path: ${path}  ${JSON.stringify(key_array)} => using: ${JSON.stringify(using)}/matched=${using.filter(v => key_array.includes(v)).length}, is_required: ${is_required} => ${result}`); *@
                    //return result;
                } catch (e) {
                    //@* console.log(`path: ${path} (${keys}) => error : ${e}`); *@
                    return false;
                }
            },
            checkBookingFieldforPickUp(path) {
                try {
                    //debugger;
                    let flight = this.bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'pickup_03' || t.trafficType?.trafficTypeValue == 'pickup_04');
                    if (flight == undefined) { return false; }
                    getValue = (o, p) => p.split('.').reduce((r, k) => r[k], o);

                    //要確認要不要加  is_flight_used
                    let is_revisible = getValue(flight, path + '.isVisible');
                    let is_required = getValue(flight, path + '.isRequire');
                    if (path.indexOf('provide') == -1) {
                        var result = is_required == "True" ? true : false;
                        return result;
                    }
                    else {
                        var result = is_revisible  == "True" ? true : false;
                        return result;
                    }

                    //let result = (using && is_required === "True") ? using.filter(v => key_array.includes(v)).length > 0 : false;
                    //@* console.log(`path: ${path}  ${JSON.stringify(key_array)} => using: ${JSON.stringify(using)}/matched=${using.filter(v => key_array.includes(v)).length}, is_required: ${is_required} => ${result}`); *@
                    //return result;
                } catch (e) {
                    //@* console.log(`path: ${path} (${keys}) => error : ${e}`); *@
                    return false;
                }
            },
            getBookingFieldReference(path) {
                if (path.indexOf('glass') == -1) {
                    getValue = (o, p) => p.split('.').reduce((r, k) => r[k], o);
                    var ref = getValue(this.bookingField, path);
                    if (ref == null) {
                        return [];
                    }
                    else {
                        let refTemp = getValue(this.bookingField, path + '.listOption');
                        return refTemp;
                    }
                    //@* console.log(`getBookingFieldReference,  path => bookingfield.${path}.${key}, vale=>${JSON.stringify(ref)}`); *@
                }
                else {
                    getValue = (o, p) => p.split('.').reduce((r, k) => r[k], o);
                    var ref = getValue(this.bookingField, path);
                    //ref = ref ? ref : [];
                    if (ref == null) {
                        return [];
                    }
                    else {
                        let start = parseFloat(ref[0].range.split('~')[0]);
                        let end = parseFloat(ref[0].range.split('~')[1]);
                        let interval = parseFloat(ref[0].interval);
                        while (start < end) {
                            refTemp.push({
                                Code: start,
                                Value: start
                            });
                            start += interval;
                        }
                        return refTemp;
                    }
                }
            },
            getBookingFieldReferenceforFlight(path) {

                let rendCar = this.bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'flight');
                getValue = (o, p) => p.split('.').reduce((r, k) => r[k], o);

                try {
                    if (flight != null) {
                        let refTemp = getValue(rendCar, path + '.listOption');
                        return refTemp;
                    }
                    else {
                        return [];
                    }
                }
                catch (e) { return []; }
            },
            getBookingFieldReferenceforRentCar(path) {

                let rendCar = this.bookingField?.traffics?.find(t => t.trafficType?.trafficTypeValue == 'rentcar_01' || t.trafficType?.trafficTypeValue == 'rentcar_02' || t.trafficType?.trafficTypeValue == 'rentcar_03' || t.trafficType?.trafficTypeValue == 'pickup_03' || t.trafficType?.trafficTypeValue == 'pickup_04' || t.trafficType?.trafficTypeValue == 'voucher');
                getValue = (o, p) => p.split('.').reduce((r, k) => r[k], o);

                try {
                    if (rendCar != null) {
                        let refTemp = getValue(rendCar, path + '.listOption');

                        if (path == 'stime' && rendCar.trafficType.trafficTypeValue == "pickup_04") {

                            refTemp.forEach(function (element) {
                                if (element.hour != 0) {
                                    element.hour = String(element.hour).padStart(2, '0');
                                    element.min = String(element.min).padStart(2, '0');
                                }
                            });
                            return refTemp;
                        }
                        else {
                            return refTemp;
                        }
                    }
                    else {
                        return [];
                    }
                }
                catch (e) { return []; }
            },
            changeShuttleTime(val) {
                $('#booking-shuttle-cus-time').find(`option:not(:first)`).remove();
                this.show_cus_shuttle = val === 'customize';

                if (this.show_cus_shuttle) {
                    let ranges = $('#booking-shuttle-time option:selected').data('range').split('~');
                    let start_time = moment.utc(ranges[0], 'HH:mm');
                    let end_time = moment.utc(ranges[1], 'HH:mm');
                    while (start_time <= end_time) {
                        $('#booking-shuttle-cus-time').append($('<option>', {
                            value: start_time.format('HH:mm'),
                            text: start_time.format('HH:mm')
                        }));
                        start_time = start_time.add(1, 'hour');
                    }
                }
                else {
                    this.booking.traffic.find(t => t.traffic_type == 'pickup_04').s_time = val;
                    
                }
            },
            refreshShoeSize(idx) {
                $(`#shoeSizeValue_${idx} option:not(:first)`).remove();
                let shoe_type = $(`#shoeSizeType_${idx}`).val();
                let shoe_unit = $(`#shoeSizeUnit_${idx}`).val();
                //@* console.log(`idx => ${idx}, type=${shoe_type}, unit=${shoe_unit}`) *@

                let sel_unit = null;

                if (shoe_type == "M") sel_unit = this.bookingField.custom.shoe.listOption.find(t => t.man).man;
                else if (shoe_type == "W") sel_unit = this.bookingField.custom.shoe.listOption.find(t => t.woman).woman;
                //@* console.log(` shoe list => ${JSON.stringify(sel_unit)}`) *@

                sel_unit = sel_unit ? sel_unit.find(u => u.UnitCode === shoe_unit) : undefined;
                //@* console.log(` final items => ${JSON.stringify(sel_unit)}`); *@

                if (sel_unit) {
                    let start = parseFloat(sel_unit.sizeRangeStart);
                    let end = parseFloat(sel_unit.sizeRangeEnd);
                    let interval = parseFloat(sel_unit.interval);
                    while (start < end) {
                        $(`#shoeSizeValue_${idx}`).append($('<option>', {
                            value: start,
                            text: start.toString()
                        }));
                        start += interval;
                    }
                }
            },
            setArrivalVisa(chk) {
                if (chk == "1") {
                    this.booking.traffic.find(t => t.traffic_type == 'flight').arrival_visa = true;
                }
                else {
                    this.booking.traffic.find(t => t.traffic_type == 'flight').arrival_visa = false;
                }
            },
            setWifi(chk) {
                if (chk == "1") {
                    this.booking.traffic.find(t => t.traffic_type.startsWith('rentcar')).provide_wifi = true;
                }
                else {
                    this.booking.traffic.find(t => t.traffic_type.startsWith('rentcar')).provide_wifi = false;
                }
            },
            setGps(chk) {
                if (chk == "1") {
                    this.booking.traffic.find(t => t.traffic_type.startsWith('rentcar')).provide_gps = true;
                }
                else {
                    this.booking.traffic.find(t => t.traffic_type.startsWith('rentcar')).provide_gps = false;
                }
            },
            setCountry(target, val) {
                //@* console.log(` target = ${target}, val => ${val}`); *@
                let cities = [];
                if (this.bookingField.custom.countryCities.listOption) {
                    let country = this.bookingField.custom.countryCities.listOption.find(n => n.id == val);
                    cities = country ? country.cities : [];
                }
                //@* console.log(`cities => ${JSON.stringify(cities)}`); *@
                $(target).find('option:not(:first)').remove();
                cities.forEach(c => {
                    $(target).append($('<option>', {
                        value: c.cityCode,
                        text: c.name
                    }));
                });

            },
             changeRentLocation(val, type) {
                 if (type === 'pick') {
                     $('#booking_pickup_time').find(`option:not(:first)`).remove();
                     $('#booking_dropoff_time').find(`option:not(:first)`).remove();

                     if (val == "") return false;
                     let _location = this.bookingField?.traffics?.find(t => t.trafficType.trafficTypeValue.startsWith('rentcar'))?.slocation?.listOption.find(o => o.id === val);
                     if (_location != undefined) {
                         let start_time = moment.utc(_location.sTime, 'HH:mm');
                         let end_time = moment.utc(_location.eTime, 'HH:mm');
                         while (start_time <= end_time) {
                             $('#booking_pickup_time').append($('<option>', {
                                 value: start_time.format('HH:mm'),
                                 text: start_time.format('HH:mm')
                             }));
                             start_time = start_time.add(_location.interval, 'minute');
                         }
                         start_time = moment.utc(_location.sTime, 'HH:mm');
                         end_time = moment.utc(_location.eTime, 'HH:mm');
                         while (start_time <= end_time) {
                             $('#booking_dropoff_time').append($('<option>', {
                                 value: start_time.format('HH:mm'),
                                 text: start_time.format('HH:mm')
                             }));
                             start_time = start_time.add(_location.interval, 'minute');
                         }
                     }
                     
                     var temp = this.booking?.traffic?.find(t => t.traffic_type.startsWith('rentcar'));
                     if (temp != undefined) { temp.e_location = val; }
                 }
                 if (type === 'drop') {
                     $('#booking_dropoff_time').find(`option:not(:first)`).remove();

                     if (val == "") return false;
                     let _location = this.bookingField.traffics.find(t => t.trafficType.trafficTypeValue.startsWith('rentcar'))?.elocation.listOption.find(o => o.id === val);
                     let start_time = moment.utc(_location.sTime, 'HH:mm');
                     let end_time = moment.utc(_location.eTime, 'HH:mm');
                     while (start_time <= end_time) {
                         $('#booking_dropoff_time').append($('<option>', {
                             value: start_time.format('HH:mm'),
                             text: start_time.format('HH:mm')
                         }));
                         start_time = start_time.add(_location.interval, 'minute');
                     }

                     //this.booking.traffic.find(t => t.car && t.car.traffic_type.startsWith('rentcar')).car.e_location = val;
                 }
            },
            changeShuttleRoute(val) {
                this.show_cus_route = (val === 'customize');
                if (this.show_cus_route) {
                    this.booking.traffic.find(t => t.traffic_type.startsWith('rentcar')).is_rent_customize = true;
                    this.booking.traffic.find(t => t.traffic_type.startsWith('rentcar')).s_location = val;
                    //this.booking.traffic.find(t => t.traffic_type.startsWith('rentcar')).s_address = ;
                }
                else {
                    this.booking.traffic.find(t => t.traffic_type.startsWith('rentcar')).is_rent_customize = false;
                    this.booking.traffic.find(t => t.traffic_type.startsWith('rentcar')).s_location = val;
                    //this.booking.traffic.find(t => t.traffic_type.startsWith('rentcar')).s_address = null;
                }
            },
            addCusRoute() {
                this.booking_custom_routes.push($('#booking-shuttle-custom-route').val());
                $('#booking-shuttle-custom-route').val('');
                if (this.booking_custom_routes.length >= 2) {
                    $('#booking-shuttle-custom-route').attr('disabled', true);
                    $('.btn-next').attr('disabled', true);
                }
                this.booking.traffic.find(t => t.traffic_type == 'rentcar_03').s_address = this.booking_custom_routes.join(',');
            },
            removeCusRoute(idx) {
                this.booking_custom_routes.splice(idx, 1);
                if (this.booking_custom_routes.length < 2) {
                    $('#booking-shuttle-custom-route').attr('disabled', false);
                    $('.btn-next').attr('disabled', false);
                }
                this.booking.traffic.find(t => t.traffic_type.startsWith('rentcar')).s_location = this.booking_custom_routes.join(',');
            },
            toBooking() {
               
                var receiverCountry = $("#receiverCountry").val();
                var receiverCity = $("#receiverCity").val();
                if (receiverCountry != undefined && receiverCity != undefined) {
                    this.booking.send.country_cities = receiverCountry + "_" + receiverCity;
                }

                console.log(`${JSON.stringify(this.booking)}`);
                let uri = `${_root_path}Booking/Booking`;
                fetch(uri, {
                    method: 'POST',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(this.booking)
                })
                    .then(response => {
                        // console.log(response.status);
                        return response.json();
                    })
                    .then(result => {
                        console.log(`${JSON.stringify(result)}`);
                        alert(result.result);
                    })
                    .catch(error => { console.error('Unable to search.', error); this.isLoading = false });

            },
            dddd() {

                var dd = this.booking;
            },

        }
    });</script>